# Functionality-generalization

Repo for our ASE paper *Can Neural Clone Detection Generalize to Unseen Functionalities?*

## Environment Configuration
```
pip install -r requirement.txt
```
then ` cd astnn/clone` go to the folder and unzip `data.7z`.

## Experiment

1、Training on a subset A and testing on a subset B of OJClone.

```
sh run.sh
```

The [`train_low`, `train_up`]，[`test_low`, `test_up`] parameter is the training set/test set range, i.e., the upper and lower limits of the question number.

2、Human-in-the-loop experiment


```
sh loop.sh
```

The human-in-the-loop approach, in which the sample with the highest uncertainty is continuously added to the training.

The parameter `k` refers to the number of samples added per loop, and the parameter `loop` refers to the number of loops.


### [Note] About sampling data

The training/test set are generated by sampling data in advance and loaded directly in the code. The upper and lower bound parameters of the question numbers mentioned above are not used to dynamically sample the data, but actually to facilitate loading the generated data from `data/c/pickles`.  

Therefore, if you wish to obtain a dataset with a different range of question numbers, you need to modify and run `sample_K.py` in the `data/c` folder to customize the sampling data.

The sampling functions include:

`make_dataset(lower, upper, problems)` :  When the parameter `problems`(list) is an empty list, the dataset with the question numbers range of [lower, upper] is generated; when it is not empty, the question number in the list is used as the generated range.

`make_dataset_without(lower, upper, problems)` : When the parameter `problems`(list) is an empty list, the dataset with question numbers in the range [1, lower) and (upper, max] is generated; when it is not empty, the question numbers in the list are used as the generated range.

`random_K(K)` :  Randomly sample K samples (need to manually modify the range of question numbers in line 176)
